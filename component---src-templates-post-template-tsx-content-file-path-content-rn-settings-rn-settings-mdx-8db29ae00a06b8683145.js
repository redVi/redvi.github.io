"use strict";(self.webpackChunkgatsby_blog=self.webpackChunkgatsby_blog||[]).push([[3640],{972:function(e,n,t){t.r(n),t.d(n,{Head:function(){return s.Ss},default:function(){return u}});var l=t(8876),a=t(4424),r=t(1892);function c(e){const n=Object.assign({p:"p",h2:"h2",a:"a",span:"span",pre:"pre",code:"code"},(0,l.MN)(),e.components);return a.createElement(a.Fragment,null,a.createElement(n.p,null,"Позволю себе привести несколько практических рекомендаций,\nкоторые позволят облегчить жизнь при работе с React Native. И себе при старте нового проекта,\nи людям, так сказать."),"\n",a.createElement(n.h2,{id:"нет-глобальному-окружению",style:{position:"relative"}},a.createElement(n.a,{href:"#%D0%BD%D0%B5%D1%82-%D0%B3%D0%BB%D0%BE%D0%B1%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%BC%D1%83-%D0%BE%D0%BA%D1%80%D1%83%D0%B6%D0%B5%D0%BD%D0%B8%D1%8E","aria-label":"нет глобальному окружению permalink",className:"anchor before"},a.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Нет глобальному окружению"),"\n",a.createElement(n.p,null,"На вебе сейчас активно используют Docker. В том числе и для того, чтобы окружение было у всех\nодинаково и, как плюс, изолировано от операционной системы. Мобильные в докере — не всегда\nхорошая идея. Но и здесь изолироваться можно."),"\n",a.createElement(n.p,null,"Для управления версиями node.js, рекомендую ",a.createElement(n.a,{href:"https://github.com/tj/n",target:"_blank",rel:"nofollow"},"n"),". Установка проста."),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-shell"},'# установить\n$ curl -L https://git.io/n-install | bash\n\n# добавить путь в .bashrc или .zshrc\n$ cat .zshrc:\nexport N_PREFIX="$HOME/n"; [[ :$PATH: == *":$N_PREFIX/bin:"* ]]\n\n# выбрать версию node\n$ n 15.5.0\n')),"\n",a.createElement(n.p,null,"По-умолчанию путь к node будет ",a.createElement(n.code,null,"${HOME}/n/bin/node"),". Чтобы Xcode мог найти его,\nнадо создать символьную ссылку."),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-shell"},"$ ln -s $(which node) /usr/local/bin/node\n")),"\n",a.createElement(n.p,null,"Если ",a.createElement(n.code,null,"n")," перестал быть нужным, удалите версию node и саму директорию,\nне забудьте поправить .bashrc/.zshrc."),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-shell"},"$ n rm 15.5.0\n$ rm -rf ~/n\n")),"\n",a.createElement(n.p,null,"Процесс изоляции и ",a.createElement(r.Link,{to:"/posts/ruby-rvm/"},"управления версиями ruby")," немногим сложнее.\nЗато при установке зависимостей для iOS никаких root-прав с нас спрашивать не будут."),"\n",a.createElement(n.h2,{id:"псевдонимы-команд",style:{position:"relative"}},a.createElement(n.a,{href:"#%D0%BF%D1%81%D0%B5%D0%B2%D0%B4%D0%BE%D0%BD%D0%B8%D0%BC%D1%8B-%D0%BA%D0%BE%D0%BC%D0%B0%D0%BD%D0%B4","aria-label":"псевдонимы команд permalink",className:"anchor before"},a.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Псевдонимы команд"),"\n",a.createElement(n.p,null,"Для разгрузки долговременной памяти можно создать псевдонимы команд в тех же ",a.createElement(n.code,null,".bashrc")," или ",a.createElement(n.code,null,".zshrc"),".\nВсе команды выполняются в директории проекта. Плюс: команда короче, её всегда можно подсмотреть."),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-bash"},'# запустить эмулятор iOS в режиме отладки\nalias run_ios="react-native run-ios --simulator=\\"iPhone 12\\" --configuration=debug"\n\n# запустить на реальном устройстве, где iPhoneName - имя вашего iPhone\nalias run_ios_on_device="react-native run-ios --simulator=\\"iPhoneName\\""\n\n# запустить эмулятор Android в режиме отладки\nalias run_android="react-native run-android --variant=debug"\n\n# запустить metro\nalias run_metro="react-native start"\n')),"\n",a.createElement(n.p,null,"Впрочем, всё это можно указать и для отдельно взятого проекта.\nТогда править надо скрипты ",a.createElement(n.code,null,"package.json"),"."),"\n",a.createElement(n.h2,{id:"импорт-относительно-корня-проекта",style:{position:"relative"}},a.createElement(n.a,{href:"#%D0%B8%D0%BC%D0%BF%D0%BE%D1%80%D1%82-%D0%BE%D1%82%D0%BD%D0%BE%D1%81%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE-%D0%BA%D0%BE%D1%80%D0%BD%D1%8F-%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B0","aria-label":"импорт относительно корня проекта permalink",className:"anchor before"},a.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Импорт относительно корня проекта"),"\n",a.createElement(n.p,null,"Многим неудобно импортировать файлы по относительному пути. В вебе эту проблему решает webpack.\nВ React Native нам поможет babel:"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-shell"},"$ yarn add -D babel-plugin-module-resolver\n")),"\n",a.createElement(n.p,null,"Изменим ",a.createElement(n.code,null,".babel.config.js")),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-js"},"module.exports = {\n  presets: ['module:metro-react-native-babel-preset'],\n  plugins: [\n    ['module-resolver',\n      {\n        root: ['./src'],\n        extensions: ['.js', '.ios.js', '.android.js'],\n      },\n    ],\n  ],\n}\n")),"\n",a.createElement(n.p,null,"Пользователям VS Code понадобится создать файл ",a.createElement(n.code,null,"jsconfig.json")," в корне проекта:"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-json"},'{\n  "compilerOptions": {\n    "target": "esnext",\n    "allowSyntheticDefaultImports": false,\n    "rootDir": "./",\n    "baseUrl": "src/"\n  },\n  "exclude": [\n    "node_modules",\n    "dist"\n  ]\n}\n')),"\n",a.createElement(n.p,null,"Настройки по вкусу, главное, чтобы ",a.createElement(n.code,null,"baseUrl")," соответствовал директории ",a.createElement(n.code,null,"root")," в ",a.createElement(n.code,null,".babel.config.js"),".\nИмпорт получится примерно такой:"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-jsx"},"import App from 'app' // обратились к файлу app.js из src/app.js\nimport { Hello } from 'components/hello' // к Hello из src/components/hello\n")),"\n",a.createElement(n.h2,{id:"очистка",style:{position:"relative"}},a.createElement(n.a,{href:"#%D0%BE%D1%87%D0%B8%D1%81%D1%82%D0%BA%D0%B0","aria-label":"очистка permalink",className:"anchor before"},a.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Очистка"),"\n",a.createElement(n.p,null,"Иногда странное поведние объясняется использованием кэша. После сброса кэша всё встаёт на свои места.\nСбросить кэш можно следующим образом:"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-shell"},"$ watchman watch-del-all\n$ rm -rf $TMPDIR/react-*\n$ yarn cache clean && rm -rf node_modules/ && yarn install\n")),"\n",a.createElement(n.p,null,"Процесс очистки от «хвостов» предыдущих сборок для разных платформ отличается."),"\n",a.createElement(n.p,null,"Для iOS:"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-shell"},"$ gem install --user-install cocoapods-deintegrate cocoapods-clean\n\n$ cd $projectName/ios\n$ pod deintegrate\n$ pod cache clean --all\n\n# удалить сборку: rm -rf ios/build\n")),"\n",a.createElement(n.p,null,"Для Android:"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-shell"},"$ cd $projectName/android\n$ ./gradlew clean\n$ ./gradlew cleanBuildCache\n\n# удалить сборку: rm -rf android/app/build\n")))}var o=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,l.MN)(),e.components);return n?a.createElement(n,e,a.createElement(c,e)):c(e)},s=t(7792),i=t(7619);function m(e){var n,t;let{data:{mdx:l},children:r,pageContext:{prev:c,next:o}}=e;const{h1:m,title:u,description:d,image:h,table_of_contents:p}=l.frontmatter;return(0,a.useEffect)((()=>{(0,i.K)()}),[]),a.createElement(a.Fragment,null,a.createElement(s._W,{h1:m,title:u,description:d,image:null===(n=l.frontmatter.image)||void 0===n?void 0:n.publicURL},a.createElement(s.MV,{post:l.frontmatter,imageData:null==h||null===(t=h.childImageSharp)||void 0===t?void 0:t.gatsbyImageData},p?a.createElement(s.G8,{headings:l.tableOfContents}):null,a.createElement("div",{className:"page__content"},r,a.createElement(s.Mf,{prev:c,next:o})),a.createElement(s.QZ,null))))}function u(e){return a.createElement(m,e,a.createElement(o,e))}},8876:function(e,n,t){t.d(n,{MN:function(){return r}});var l=t(4424);const a=l.createContext({});function r(e){const n=l.useContext(a);return l.useMemo((()=>"function"==typeof e?e(n):{...n,...e}),[n,e])}}}]);