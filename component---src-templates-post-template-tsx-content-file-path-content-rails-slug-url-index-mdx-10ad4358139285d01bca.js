"use strict";(self.webpackChunkgatsby_blog=self.webpackChunkgatsby_blog||[]).push([[9372],{3772:function(e,t,n){n.r(t),n.d(t,{Head:function(){return u.Ss},default:function(){return i}});var l=n(8876),a=n(4424);function r(e){const t=Object.assign({p:"p",a:"a",code:"code",pre:"pre"},(0,l.MN)(),e.components);return a.createElement(a.Fragment,null,a.createElement(t.p,null,"В ",a.createElement(t.a,{href:"/posts/get-absolute-url/"},"предыдущем посте")," к рассмотрению был предложен\nвопрос о назначении собственных уникальных URL-адресов страницы и получения\nих полного пути. Сегодня тема та же, но другой фреймворк: для сравнения\nпосмотрим как того же самого результата можно добиться в Ruby On Rails."),"\n",a.createElement(t.p,null,"Собственно, почему вдруг Ruby? Нет, не будет утверждений будто он хуже или\nлучше Python'а, просто случайно попался на пути и весьма заинтриговал автора.\nЭтого достаточно, чтобы черкнуть о нём пару строк. Не исключено (если\nдружба наша с Ruby станет крепнуть), что время от времени здесь будут\nпоявляться небольшие заметки о Ruby или Ruby On Rails."),"\n",a.createElement(t.p,null,"Подробных объяснений базовых вещей сегодня не предвидится. Если читателю\nранее не доводилось встречаться с Rails, есть\n",a.createElement(t.a,{href:"http://ruby.railstutorial.org/ruby-on-rails-tutorial-book",target:"_blank",rel:"nofollow"},"добротное пошаговое руководство"),",\nдостаточное для быстрого старта и понимания приведённого ниже материала."),"\n",a.createElement(t.p,null,"Зададим маршрут в ",a.createElement(t.code,null,"app/config/routes.rb"),":"),"\n",a.createElement(t.pre,null,a.createElement(t.code,{className:"language-ruby"},"# routes.rb:\nget 'articles/:slug' => 'articles#show'\n")),"\n",a.createElement(t.p,null,"Это указание на то, что при обращении к странице будет вызван метод ",a.createElement(t.code,null,"show"),"\nиз контроллёра ",a.createElement(t.code,null,"articles_controller.rb"),", отвечающего за вывод публикаций."),"\n",a.createElement(t.p,null,"Перепроводим маршруты:"),"\n",a.createElement(t.pre,null,a.createElement(t.code,{className:"language-shell"},"$ rake routes\n")),"\n",a.createElement(t.p,null,"Далее обратимся к указанному выше контроллёру. Он содержит различные методы,\nоперирующие нашей моделью. В примере ниже находит публикацию по определённым параметрам."),"\n",a.createElement(t.pre,null,a.createElement(t.code,{className:"language-ruby"},"# articles_controller.rb\n\ndef show\n  @article=Article.find_by_slug!(params[:id])\nend\n\nprivate\n  def article_params\n    params.require(:article).permit(:title, :content, :slug)\n  end\n")),"\n",a.createElement(t.p,null,"Собственно, модель. Здесь нас и поджидает самое интересное. Перед тем, как публикация будет записана в БД, создаётся поле ",a.createElement(t.code,null,"slug"),". Для указания этого действия мы определяем ",a.createElement(t.code,null,"before_create"),", в который передаём название функции — ",a.createElement(t.code,null,"create_slug"),"."),"\n",a.createElement(t.p,null,"Можно каждый раз при создании статьи назначать её ",a.createElement(t.code,null,"slug")," вручную. Или же создавать это поле автоматически, исходя из названия статьи."),"\n",a.createElement(t.p,null,"Если с английским языком всё более или менее понятно, то автоматический перевод с кириллицы на латиницу может совсем не радовать, поэтому в общем случае предлагается использовать первый вариант."),"\n",a.createElement(t.pre,null,a.createElement(t.code,{className:"language-ruby"},"# article.rb\n\nclass Article < ActiveRecord::Base\n  before_create :create_slug\n\n  default_scope order: 'articles.created_at DESC' # сортировка статей\n  validates :slug, presence: true, length: {maximum:30} # валидация\n\n  def to_param\n    \"#{slug}/\".downcase # как выводить в URL\n  end\n\n  def create_slug\n    # если в модели определено поле slug, slug задаётся вручную\n    self.slug=self.slug.parameterize\n    # если поле slug не определено, генерируется автоматически\n    # исходя из значения поля title (заголовок статьи)\n    # self.slug=self.title.parameterize\n  end\nend\n")),"\n",a.createElement(t.p,null,"Наконец, пример вывода страницы публикации ",a.createElement(t.code,null,"show.html.erb"),"."),"\n",a.createElement(t.pre,null,a.createElement(t.code,{className:"language-erb"},'<% provide(:title, @article.title) %>\n<h2><%= link_to @article.title, article_path(@article) %></h2>\n<h5><%= @article.created_at.strftime("%d %B") %></h5>\n<%= @article.content %>\n')))}var c=function(e){void 0===e&&(e={});const{wrapper:t}=Object.assign({},(0,l.MN)(),e.components);return t?a.createElement(t,e,a.createElement(r,e)):r(e)},u=n(7792),s=n(7619);function o(e){var t,n;let{data:{mdx:l},children:r,pageContext:{prev:c,next:o}}=e;const{h1:i,title:m,description:p,image:d,table_of_contents:g}=l.frontmatter;return(0,a.useEffect)((()=>{(0,s.K)()}),[]),a.createElement(a.Fragment,null,a.createElement(u._W,{h1:i,title:m,description:p,image:null===(t=l.frontmatter.image)||void 0===t?void 0:t.publicURL},a.createElement(u.MV,{post:l.frontmatter,imageData:null==d||null===(n=d.childImageSharp)||void 0===n?void 0:n.gatsbyImageData},g?a.createElement(u.G8,{headings:l.tableOfContents}):null,a.createElement("div",{className:"page__content"},r,a.createElement(u.Mf,{prev:c,next:o})),a.createElement(u.QZ,null))))}function i(e){return a.createElement(o,e,a.createElement(c,e))}},8876:function(e,t,n){n.d(t,{MN:function(){return r}});var l=n(4424);const a=l.createContext({});function r(e){const t=l.useContext(a);return l.useMemo((()=>"function"==typeof e?e(t):{...t,...e}),[t,e])}}}]);