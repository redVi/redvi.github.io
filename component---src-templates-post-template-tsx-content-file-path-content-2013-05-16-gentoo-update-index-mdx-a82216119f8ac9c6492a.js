"use strict";(self.webpackChunkgatsby_blog=self.webpackChunkgatsby_blog||[]).push([[4496],{4596:function(e,n,a){a.r(n),a.d(n,{Head:function(){return o.Ss},default:function(){return g}});var l=a(8876),t=a(4424);function s(e){const n=Object.assign({p:"p",h2:"h2",a:"a",span:"span",h3:"h3",h4:"h4",ul:"ul",li:"li",blockquote:"blockquote"},(0,l.MN)(),e.components);return t.createElement(t.Fragment,null,t.createElement(n.p,null,"После установки и первоначальной настройки пользователю gentoo\nlinux, кажется, уже не о чем больше беспокоиться. Разве что о такой\nважной вещи как поддержание своей операционной системы в актуальном состоянии. Собственно, этот вопрос и будет затронут сегодня. Детально разберём особенности обновления gentoo, немного поговорим о командах и программах, с которыми не мешало бы разобраться каждому гентушнику, ну и постараемся предугадать и осветить возможные вопросы начинающих пользователей. Начнём, пожалуй."),"\n",t.createElement(n.p,null,"В тексте вы можете видеть сноски, выделенные красным цветом и более мелким по сравнению с основным текстом шрифтом. Дело в том, что пост получился довольно таки объёмным и затрагивает не только сам процесс обновления, но и процесс взаимодействия/сосуществования с gentoo, поэтому пришлось вынести некоторые дополнительные материалы в заключение."),"\n",t.createElement(n.h2,{id:"введение",style:{position:"relative"}},t.createElement(n.a,{href:"#%D0%B2%D0%B2%D0%B5%D0%B4%D0%B5%D0%BD%D0%B8%D0%B5","aria-label":"введение permalink",className:"anchor before"},t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Введение"),"\n",t.createElement(n.p,null,'На земле Gentoo обновление понимается иначе, чем в большинстве существующих дистрибутивов linux. Gentoo никогда не был предназначен для "классического" способа обновления программ: дождаться нового релиза, скачать его, прожечь, поместить диск в привод и следовать инструкции по обновлению. Такой процесс  вряд ли может удовлетворить опытных пользователей, желающих иметь свежее программное обеспечение. С самого начала, Gentoo был разработан вокруг концепции быстрых последовательных обновлений. В идеале, вы устанавливаете систему один раз, и никогда не беспокоитесь о выпусках: просто следуете инструкциям из Введения в Portage в настольной книге Gentoo, которые объясняют, как сохранить вашу систему в актуальном состоянии. Хотя  иногда вносятся изменения в ядро ​​ОС и требуется его ручное обновление.'),"\n",t.createElement(n.p,null,"Но в Gentoo есть и релизы. Новый релиз означает появление нового установочного диска, исправленного и дополненного. Диск содержит актуальные/свежие пакеты для новых установок, иногда реализуются функции, несовместимые с предыдущими выпусками. В таком случае принято говорить о новом профиле. Профиль - набор конфигурационных файлов, хранимых а каталоге ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">/usr/portage/profiles</code>'}}),". Профили, устаревающие с появлением новых, хранятся в  ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">/usr/portage/profiles</code>'}})," наряду с текущими, но они помечены как устаревшие. Portage уведомит вас о необходимости ",t.createElement(n.a,{href:"http://www.gentoo.org/doc/en/gentoo-upgrading.xml",target:"_blank",rel:"nofollow"},"перехода на новый профиль"),"."),"\n",t.createElement(n.h2,{id:"часть-1-обновление",style:{position:"relative"}},t.createElement(n.a,{href:"#%D1%87%D0%B0%D1%81%D1%82%D1%8C-1-%D0%BE%D0%B1%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5","aria-label":"часть 1 обновление permalink",className:"anchor before"},t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Часть 1. Обновление"),"\n",t.createElement(n.h3,{id:"как-часто-следует-обновляться",style:{position:"relative"}},t.createElement(n.a,{href:"#%D0%BA%D0%B0%D0%BA-%D1%87%D0%B0%D1%81%D1%82%D0%BE-%D1%81%D0%BB%D0%B5%D0%B4%D1%83%D0%B5%D1%82-%D0%BE%D0%B1%D0%BD%D0%BE%D0%B2%D0%BB%D1%8F%D1%82%D1%8C%D1%81%D1%8F","aria-label":"как часто следует обновляться permalink",className:"anchor before"},t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Как часто следует обновляться?"),"\n",t.createElement(n.p,null,"Не чаще, чем раз в сутки. Более частое обновление просто не имеет смысла. Вообще, обновление сроком до месяца не должно повлечь за собой никаких проблем. Если вы предпочитаете обновлять систему периодом от полугода до примерно восьми месяцев одна проблема будет точно: большое количество пакетов, требующих обновления, и связанные с этим временные затраты. Обновление сроком от года и выше может и, вероятно, потребует ",t.createElement(n.a,{href:"http://www.gentoo.ru/content/kak-obnovit-ochen-staruyu-sistemu",target:"_blank",rel:"nofollow"},"вашего пристального внимания"),"."),"\n",t.createElement(n.h3,{id:"процесс-обновления-системы",style:{position:"relative"}},t.createElement(n.a,{href:"#%D0%BF%D1%80%D0%BE%D1%86%D0%B5%D1%81%D1%81-%D0%BE%D0%B1%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F-%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D1%8B","aria-label":"процесс обновления системы permalink",className:"anchor before"},t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Процесс обновления системы"),"\n",t.createElement(n.p,null,"Обновление системы состоит из нескольких этапов."),"\n",t.createElement(n.h4,{id:"первый-этап-обновление-дерева-портежей-иили-используемых-дополнительных-оверлеев",style:{position:"relative"}},t.createElement(n.a,{href:"#%D0%BF%D0%B5%D1%80%D0%B2%D1%8B%D0%B9-%D1%8D%D1%82%D0%B0%D0%BF-%D0%BE%D0%B1%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%B4%D0%B5%D1%80%D0%B5%D0%B2%D0%B0-%D0%BF%D0%BE%D1%80%D1%82%D0%B5%D0%B6%D0%B5%D0%B9-%D0%B8%D0%B8%D0%BB%D0%B8-%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85-%D0%B4%D0%BE%D0%BF%D0%BE%D0%BB%D0%BD%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D1%8B%D1%85-%D0%BE%D0%B2%D0%B5%D1%80%D0%BB%D0%B5%D0%B5%D0%B2","aria-label":"первый этап обновление дерева портежей иили используемых дополнительных оверлеев permalink",className:"anchor before"},t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Первый этап: обновление дерева портежей и/или используемых дополнительных оверлеев."),"\n",t.createElement(n.p,null,"Осуществляется командой ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">emerge --sync</code>'}}),"\n(или ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">emerge-webrsync</code>'}}),", что позволит сэкономить трафик и время)"),"\n",t.createElement(n.h4,{id:"второй-этап-обновление-пакетов",style:{position:"relative"}},t.createElement(n.a,{href:"#%D0%B2%D1%82%D0%BE%D1%80%D0%BE%D0%B9-%D1%8D%D1%82%D0%B0%D0%BF-%D0%BE%D0%B1%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2","aria-label":"второй этап обновление пакетов permalink",className:"anchor before"},t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Второй этап: обновление пакетов"),"\n",t.createElement(n.p,null,"Обновление установленных программ:"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token comment"># emerge -pvuND --with-bdeps=y world</span></code></pre></div>'}}),"\n",t.createElement(n.p,null,"Нужно не полениться и прочесть вывод команды. При необходимости устранить блокировки (дополнить/поправить список USE-флагов в ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">/etc/make.conf</code>'}})," и ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">/etc/portage/package.use</code>'}}),"), согласиться с предлагаемой последовательностью действий или исправить её в соответствии со своими представлениями о здравом смысле.\nПосле чего выполнить обновление:"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token comment"># emerge -uND world</span></code></pre></div>'}}),"\n",t.createElement(n.p,null,"Иногда может оказаться полезной опция ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">--with-bdeps=y</code>'}}),", которая заставляет обновиться пакеты, требующиеся только во время сборки пакета, даже в том случае, когда пакету, который их вытянул, обновление не требуется."),"\n",t.createElement(n.p,null,"После вышеуказанных действий также может потребоваться обновление конфигурационных файлов, о чём, впрочем, напомнит ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">portage</code>'}}),", если вы не будете игнорировать его сообщения. Для этого используем ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">etc-update</code>'}})," или ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">dispatch-conf</code>'}}),"."),"\n",t.createElement(n.h4,{id:"третий-этап-чистка-системы",style:{position:"relative"}},t.createElement(n.a,{href:"#%D1%82%D1%80%D0%B5%D1%82%D0%B8%D0%B9-%D1%8D%D1%82%D0%B0%D0%BF-%D1%87%D0%B8%D1%81%D1%82%D0%BA%D0%B0-%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D1%8B","aria-label":"третий этап чистка системы permalink",className:"anchor before"},t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Третий этап: чистка системы"),"\n",t.createElement(n.p,null,"Проверка и пересборка битых зависимостей осуществляется командой ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">revdep-rebuild</code>'}}),"."),"\n",t.createElement(n.p,null,"В случае обновления python'а --- ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">python-updater</code>'}}),"."),"\n",t.createElement(n.p,null,"Для тех, у кого установлен haskell и/или perl: ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">haskell-updater</code>'}})," и ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">perl-cleaner</code>'}})," в помощь."),"\n",t.createElement(n.p,null,"Удаление ставших ненужными пакетов:"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token comment"># emerge -pv --depclean</span></code></pre></div>'}}),"\n",t.createElement(n.p,null,"Тут не надо полагаться на продвинутость ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">emerge</code>'}})," целиком и полностью. Лучше посмотреть не тащит ли ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">depclean</code>'}})," лишних пакетов. Особенно актуально для X Window System. У автора в результате её беспечности ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">depclean</code>'}})," однажды снёс нужную иксам, но необязательную по мнению emerge библиотеку ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">libXinerama</code>'}}),", после чего, как и следует предположить, иксы не запустились. Итак, если ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">depclean</code>'}})," хочет удалить нужный пакет -  установите этот пакет явно или пропишите в ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">world</code>'}}),", дабы больше его не дёргали. Если удаляет что-то из существенного (gcc, python, возможно xorg) - реконфигурйте систему в соответствии с руководствами с gentoo.org.\nРазобравшись с этим, можно избавиться от пакетов, которые больше не требуются:"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token comment"># emerge --depclean</span></code></pre></div>'}}),"\n",t.createElement(n.p,null,"Ещё раз проверить на предмет сломанных зависимостей с помощью ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">revdep-rebuild</code>'}}),"."),"\n",t.createElement(n.p,null,"Удалить неиспользуемые исходники:"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token comment"># eclean-dist</span></code></pre></div>'}}),"\n",t.createElement(n.h3,{id:"обновление-ядра",style:{position:"relative"}},t.createElement(n.a,{href:"#%D0%BE%D0%B1%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D1%8F%D0%B4%D1%80%D0%B0","aria-label":"обновление ядра permalink",className:"anchor before"},t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Обновление ядра"),"\n",t.createElement(n.p,null,"Ядро — особый пакет. И отношения к себе заслуживает особого. Portage удаляет только те файлы, который сам установил. Поэтому после обновления в ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">/usr/src/</code>'}})," остаёся каталог ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">kernel-$VERSION</code>'}}),", содержащий оставшиеся после сборки ядра временные файлы."),"\n",t.createElement(n.p,null,"Его (как и ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">/lib/modules/$VERSION</code>'}}),") можно удалить ручками (но только когда они совсем не нужны, до получения подтверждения полной работоспособности нового ядра категорически рекомендуется оставить возможность загрузки со старым ядром!)."),"\n",t.createElement(n.p,null,"Если нет желания каждый раз конфигурировать ядро с нуля, то можно взять за основу существующий конфигурационный файл. Берём из ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">/proc/config.gz</code>'}}),"."),"\n",t.createElement(n.p,null,"Символьная ссылка ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">/usr/src/linux/</code>'}})," должна указывать на каталог, содержащий исходники ядра, которое предполагается собирать. Чтобы это условие выполнялось, потребуется произвести следующие манипуляции:"),"\n",t.createElement(n.p,null,"Сразу переключиться на новое ядро с помощью ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">eselect</code>'}}),"."),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">$ eselect kernel list\nAvailable kernel symlink targets:\n    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>   linux-3.6.11-gentoo*\n    <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>   linux-3.7.7-gentoo\n<span class="token comment"># eselect kernel set 2</span></code></pre></div>'}}),"\n",t.createElement(n.p,null,"Проверяем создалась ли автоматически символьная ссылка на новое ядро:"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">$ <span class="token function">ls</span> <span class="token parameter variable">-l</span> /usr/src/linux\nlrwxrwxrwx <span class="token number">1</span> root root  /usr/src/linux -<span class="token operator">></span> linux-3.7.7/</code></pre></div>'}}),"\n",t.createElement(n.p,null,"Отлично! Если это не так, создаём вручную:"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token comment"># ln -sfn /usr/src/linux-3.7.7 /usr/src/linux</span></code></pre></div>'}}),"\n",t.createElement(n.p,null,"Собственно, сборка нового ядра:"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token comment"># cd /usr/src/linux</span>\n<span class="token comment"># zcat /proc/config.gz > .config</span>\n<span class="token comment"># make oldconfig</span>\n<span class="token comment"># make menuconfig</span>\n<span class="token comment"># make &amp;&amp; make modules_install</span>\n<span class="token comment"># cp arch/$ARCH/boot/bzImage /boot/linux-$VERSION</span></code></pre></div>'}}),"\n",t.createElement(n.p,null,"После сборки нужно подправить в ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">/boot/grub/menu.lst</code>'}})," строки с версией ядра (справедливо для загрузчика ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">grub-legacy</code>'}}),")."),"\n",t.createElement(n.p,null,"Теперь вы сможете загрузиться с новым ядром."),"\n",t.createElement(n.p,null,"Возможно, придётся пересобрать некоторые программы,\nесли они используют свои модули. В частности это относится к ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">virtualbox-modules</code>'}}),".\nВы можете сделать это вручную или использовать ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">module-rebuild</code>'}}),":"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token comment"># cd /usr/src/linux</span>\n<span class="token comment"># make modules_prepare</span>\n<span class="token comment"># emerge --ask @module-rebuild</span></code></pre></div>'}}),"\n",t.createElement(n.h3,{id:"если-обновился-gcc",style:{position:"relative"}},t.createElement(n.a,{href:"#%D0%B5%D1%81%D0%BB%D0%B8-%D0%BE%D0%B1%D0%BD%D0%BE%D0%B2%D0%B8%D0%BB%D1%81%D1%8F-gcc","aria-label":"если обновился gcc permalink",className:"anchor before"},t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Если обновился gcc"),"\n",t.createElement(n.p,null,"Согласно методическому руководству при обновлении ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">gcc</code>'}})," достаточно переключиться на его новую версию и пересобрать с ним только ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">sys-devel/libtool</code>'}}),":"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token comment"># gcc-config -l</span>\n<span class="token comment"># gcc-config 2</span>\n<span class="token comment"># env-update &amp;&amp; source /etc/profile</span>\n<span class="token comment"># emerge --oneshot libtool</span></code></pre></div>'}}),"\n",t.createElement(n.h3,{id:"если-система-долго-не-обновлялась",style:{position:"relative"}},t.createElement(n.a,{href:"#%D0%B5%D1%81%D0%BB%D0%B8-%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D0%B0-%D0%B4%D0%BE%D0%BB%D0%B3%D0%BE-%D0%BD%D0%B5-%D0%BE%D0%B1%D0%BD%D0%BE%D0%B2%D0%BB%D1%8F%D0%BB%D0%B0%D1%81%D1%8C","aria-label":"если система долго не обновлялась permalink",className:"anchor before"},t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Если система долго не обновлялась"),"\n",t.createElement(n.p,null,"Во избежание проблем лучше последовательно выполнить данные ниже рекомендации."),"\n",t.createElement(n.p,null,"Внимательно прочесть новости, которые любезно предоставляет нам emerge при синхронизации"),"\n",t.createElement(n.p,null,"Согласно рекомендации обновить ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">portage</code>'}})," командой"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token comment"># emerge -1 portage</span></code></pre></div>'}}),"\n",t.createElement(n.p,null,"Обновить ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">gcc</code>'}}),":"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token comment"># emerge -1 gcc</span></code></pre></div>'}}),"\n",t.createElement(n.p,null,"Переключиться на новый компилятор и пересобрать ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">libtool</code>'}})),"\n",t.createElement(n.p,null,"Новым компилятором пересобрать ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">system</code>'}}),":"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token comment"># emerge -ave system</span></code></pre></div>'}}),"\n",t.createElement(n.p,null,"Пересобрать драйвера иксов."),"\n",t.createElement(n.p,null,"Дообновить оставшееся, после чего можно переходить ",t.createElement(n.a,{href:"http://gentoo.ru/content/ustanovil-ya-gentoo-dalshe-chto",target:"_blank",rel:"nofollow"},"к чистке системы"),"."),"\n",t.createElement(n.h2,{id:"часть-2-основы-сосуществования-с-gentoo",style:{position:"relative"}},t.createElement(n.a,{href:"#%D1%87%D0%B0%D1%81%D1%82%D1%8C-2-%D0%BE%D1%81%D0%BD%D0%BE%D0%B2%D1%8B-%D1%81%D0%BE%D1%81%D1%83%D1%89%D0%B5%D1%81%D1%82%D0%B2%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F-%D1%81-gentoo","aria-label":"часть 2 основы сосуществования с gentoo permalink",className:"anchor before"},t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Часть 2. Основы сосуществования с gentoo"),"\n",t.createElement(n.p,null,"Теперь стоило бы рассмотреть вещи, к обновлению не относящиеся, но оттого не менее нужные"),"\n",t.createElement(n.h3,{id:"использование-оверлеев",style:{position:"relative"}},t.createElement(n.a,{href:"#%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-%D0%BE%D0%B2%D0%B5%D1%80%D0%BB%D0%B5%D0%B5%D0%B2","aria-label":"использование оверлеев permalink",className:"anchor before"},t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Использование оверлеев"),"\n",t.createElement(n.p,null,"Не помешает установить утилиту ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">app-portage/eix</code>'}})," для поиска по неустановленным оверлеям. После чего следует сформировать базу пакетов. В последующем эта команда позволит обновлять созданную базу:"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token comment"># eix-remote update</span></code></pre></div>'}}),"\n",t.createElement(n.p,null,"Кстати, найти нужный пакет и посмотреть в каком оверлее тот находится\nможно ",t.createElement(n.a,{href:"http://gpo.zugaina.org/",target:"_blank",rel:"nofollow"},"здесь"),"."),"\n",t.createElement(n.p,null,"Теперь нам потребуется ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">layman</code>'}}),":"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token comment"># emerge -av app-portage/layman</span></code></pre></div>'}}),"\n",t.createElement(n.p,null,"Указываем настройки в ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">/etc/portage/make.conf</code>'}}),":"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token builtin class-name">source</span> /var/lib/layman/make.conf\n<span class="token assign-left variable">PORTDIR_OVERLAY</span><span class="token operator">=</span><span class="token string">"<span class="token variable">${PORTDIR_OVERLAY}</span> /usr/local/portage"</span></code></pre></div>'}}),"\n",t.createElement(n.p,null,"Далее следует обновление списка оверлеев и их просмотр:"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token comment"># layman --fetch</span>\n<span class="token comment"># layman --list</span></code></pre></div>'}}),"\n",t.createElement(n.p,null,"Добавить нужный оверлей:"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token comment"># layman -L | grep my_overlay</span>\n<span class="token comment"># layman --add my_overlay</span></code></pre></div>'}}),"\n",t.createElement(n.p,null,"Обновить все оверлеи:"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token comment"># layman -S</span></code></pre></div>'}}),"\n",t.createElement(n.p,null,"Удалить оверлей, ставший ненужным:"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token comment"># layman --delete my_overlay</span></code></pre></div>'}}),"\n",t.createElement(n.p,null,"Перед поиском программ из только что установленного оверлея, следует обновить базу ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">eix</code>'}}),":"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token comment"># eix-update</span></code></pre></div>'}}),"\n",t.createElement(n.p,null,"Просмотреть все пакеты оверлея (в том числе и установленные вами) также\nпредставляется возможным. Для этого будем использовать команду:"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">$ eix --in-overlay <span class="token variable">$OVERLAY_NAME</span></code></pre></div>'}}),"\n",t.createElement(n.h3,{id:"блокировки",style:{position:"relative"}},t.createElement(n.a,{href:"#%D0%B1%D0%BB%D0%BE%D0%BA%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B8","aria-label":"блокировки permalink",className:"anchor before"},t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Блокировки"),"\n",t.createElement(n.p,null,'Блокировки можно условно разделить на два типа: просто блокировки\n(их называют жёсткими) и "недоблокировки" (а эти — мягкими). Первые обозначаются заглавной ',t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">B</code>'}})," и требуют к себе предельного внимания. Тут без вашего вмешательства обновление или же установка пакетов не произойдёт. Иначе говоря, ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">emerge</code>'}})," сигнализирует, что не может без вас разобраться.\nВообще, жёсткие блокировки возникают, когда два (и почти никогда больше) пакета не могут быть установлены вместе. Либо вы хотите установить программу, которая требует в зависимотсях более новый пакет, чем тот, что у вас установлен, либо программы выполняют одинаковые функции и вместе сосуществовать не могут. Например, ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">udev</code>'}})," и ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">eudev</code>'}}),"."),"\n",t.createElement(n.p,null,"Как можно поступить:"),"\n",t.createElement(n.ul,null,"\n",t.createElement(n.li,null,"замаскировать один из пакетов"),"\n",t.createElement(n.li,null,"удовлетворить требования emerge. Применительно к вышеуказанным ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">udev/eudev</code>'}}),": удалить один из них и поставить другой."),"\n",t.createElement(n.li,null,"устанановить, наплевав на предупрежение. Не стоит этого делать (правда не стоит), но если не послушаетесь, ставьте конфликтующий пакет с ключиком ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">-O</code>'}})),"\n"),"\n",t.createElement(n.p,null,"На мягкие блокировки даже не надо тратить своего времени - portage сам разрулит. Обозначаются они ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">b</code>'}}),"строчной."),"\n",t.createElement(n.h3,{id:"makeconf",style:{position:"relative"}},t.createElement(n.a,{href:"#makeconf","aria-label":"makeconf permalink",className:"anchor before"},t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"make.conf"),"\n",t.createElement(n.blockquote,null,"\n",t.createElement(n.p,null,"Не держись указа аки стенки. К каждому указу надобно и голову приложить. © Пётр I"),"\n"),"\n",t.createElement(n.p,null,"Сие предупреждение к тому, чтобы читатель не рвался слепо копировать всё из примера в свой make.conf. Это не убунту, думайте и расширяйте этот файл по мере необходимости. Значений может быть меньше, чем в примере, а может быть намного больше."),"\n",t.createElement(n.p,null,"Пример настройки ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">make.conf</code>'}})," есть на странице ",t.createElement(n.a,{href:"https://old.calculate-linux.org/main/ru/make_conf",target:"_blank",rel:"nofollow"},"calculate-linux")),"\n",t.createElement(n.p,null,"Дополнительные сведения можно найти в блоге, курсируя по тегу gentoo, или открыть ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">man make.conf</code>'}})," (особое внимание уделите блоку ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">FEATURES</code>'}}),", вам понравится)."),"\n",t.createElement(n.h3,{id:"use-флаги",style:{position:"relative"}},t.createElement(n.a,{href:"#use-%D1%84%D0%BB%D0%B0%D0%B3%D0%B8","aria-label":"use флаги permalink",className:"anchor before"},t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"USE-флаги"),"\n",t.createElement(n.p,null,"Тут всё достаточно тривиально. Большинство флагов определяет выбранный вами профиль. Посмотреть список доступных профилей можно командой"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">$ eselect profile list:\n\nAvailable profile symlink targets:\n<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>   default/linux/amd64/10.0 *\n<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>   default/linux/amd64/10.0/selinux\n<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>   default/linux/amd64/10.0/desktop\n<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span>   default/linux/amd64/10.0/desktop/gnome\n<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span>   default/linux/amd64/10.0/desktop/kde\n<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span>   default/linux/amd64/10.0/developer\n<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span>   default/linux/amd64/10.0/no-multilib\n<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span>   default/linux/amd64/10.0/server\n<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span>   default/linux/amd64/10.0/x32\n<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span>  default/linux/amd64/13.0\n<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span>  default/linux/amd64/13.0/selinux\n<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span>  default/linux/amd64/13.0/desktop\n<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span>  default/linux/amd64/13.0/desktop/gnome\n<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span>  default/linux/amd64/13.0/desktop/kde\n<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span>  default/linux/amd64/13.0/developer\n<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span>  default/linux/amd64/13.0/no-multilib\n<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span>  default/linux/amd64/13.0/x32\n<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span>  hardened/linux/amd64\n<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span>  hardened/linux/amd64/selinux\n<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span>  hardened/linux/amd64/no-multilib\n<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span>  hardened/linux/amd64/no-multilib/selinux\n<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span>  hardened/linux/uclibc/amd64</code></pre></div>'}}),"\n",t.createElement(n.p,null,"Можно выбрать дефолтный профиль, а затем задать необходимые USE-флаги. Или\nвыбрать наиболее подходящий вам профиль и дополнять его.\nПеред тем, как установить пакет, просмотрите с какими USE-флагами он может\nбыть собран и впишите свои значения в ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">/etc/portage/package.use</code>'}}),".\nПример:"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">$ emerge <span class="token parameter variable">-av</span> mirage\n\nThis action requires superuser access<span class="token punctuation">..</span>.\nWould you like to <span class="token function">add</span> <span class="token parameter variable">--pretend</span> to options? <span class="token punctuation">[</span>Yes/No<span class="token punctuation">]</span> y\nThese are the packages that would be merged, <span class="token keyword">in</span> order: Calculating dependencies<span class="token punctuation">..</span>. done<span class="token operator">!</span>\n<span class="token punctuation">[</span>ebuild   R    <span class="token punctuation">]</span> media-gfx/mirage-0.9.5.1  <span class="token number">0</span> kB jpeg png gif jpeg2k <span class="token parameter variable">-gnome</span></code></pre></div>'}}),"\n",t.createElement(n.p,null,"Допустим, нам нужно, чтобы mirage умел просматривать файлы .png и .jpeg,\nа .gif и гном игнорировал. В соответствии с этим пропишем:"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token comment"># nano /etc/portage/package.use</span>\nmedia-gfx/mirage jpeg png <span class="token parameter variable">-gif</span> jpeg2k <span class="token parameter variable">-gnome</span></code></pre></div>'}}),"\n",t.createElement(n.p,null,"Теперь emerge не потянет ненужных нам зависимостей в следствие чего\nсократится время сборки да и места на диске больше останется ;)\nДля пересборки пакета с новыми флагами следует добавить ключ ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">--newuse</code>'}}),".\nЕсли вы не знаете или не уверены в том, какие флаги выставить, можно получить о каждом из них более подробную информацию. Установите ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">gentoolkit</code>'}})," и используйте команду ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">equery uses</code>'}})," нужный_пакет:"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">$ equery uses python\n\n--- вывод сокращён --\n* Found these USE flags <span class="token keyword">for</span> dev-lang/python-3.2.3:\n- - build        <span class="token builtin class-name">:</span> <span class="token operator">!</span><span class="token operator">!</span>internal use only<span class="token operator">!</span><span class="token operator">!</span> DO NOT SET THIS FLAG YOURSELF<span class="token operator">!</span>\n- - doc          <span class="token builtin class-name">:</span> Adds extra documentation <span class="token punctuation">(</span>API, Javadoc, etc<span class="token punctuation">)</span>\n- - examples     <span class="token builtin class-name">:</span> Install examples, usually <span class="token builtin class-name">source</span> code\n- - ipv6         <span class="token builtin class-name">:</span> Adds support <span class="token keyword">for</span> IP version <span class="token number">6</span>\n+ + ssl          <span class="token builtin class-name">:</span> Adds support <span class="token keyword">for</span> Secure Socket Layer connections\n+ + tk           <span class="token builtin class-name">:</span> Adds support <span class="token keyword">for</span> Tk GUI toolkit\n- + wide-unicode <span class="token builtin class-name">:</span> Enable wide Unicode implementation <span class="token function">which</span> uses <span class="token number">4</span>-byte Unicode characters.\n- - wininst      <span class="token builtin class-name">:</span> Install Windows executables required\n+ + xml          <span class="token builtin class-name">:</span> Add support <span class="token keyword">for</span> XML files</code></pre></div>'}}),"\n",t.createElement(n.ul,null,"\n",t.createElement(n.li,null,"если набрать команду ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">equery depends пакет</code>'}}),", будут указаны все пакеты, зависящие от выбранного"),"\n",t.createElement(n.li,null,"когда вы желаете использовать версию программы, отличную от используемой по-умолчанию, воспользуйтесь ",t.createElement(n.a,{href:"http://www.gentoo.org/doc/en/gentoolkit.xml",target:"_blank",rel:"nofollow"},"командой ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">eselect</code>'}})),". Например:"),"\n",t.createElement(n.li,null,"исходники установленных приложений можно найти по пути ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">/usr/portage/distfiles/</code>'}})),"\n",t.createElement(n.li,null,"если нужно лишь загрузить исходники, но не устанавливать программу, используйте флаг ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">--fetchonly</code>'}})),"\n",t.createElement(n.li,null,"если у вас установлен python3, пересоберите portage с соответствующим флагом (",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">+python3</code>'}}),") для увеличения производительности portage в среднем на 15%."),"\n"),"\n",t.createElement(n.p,null,"Пример с ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">eselect</code>'}}),":"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token comment"># eselect python list</span>\nAvailable Python interpreters:\n    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>   python2.7\n    <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>   python3.2 *\n<span class="token comment"># eselect python set 1</span></code></pre></div>'}}),"\n",t.createElement(n.h3,{id:"зачем-нужны-ebuildы",style:{position:"relative"}},t.createElement(n.a,{href:"#%D0%B7%D0%B0%D1%87%D0%B5%D0%BC-%D0%BD%D1%83%D0%B6%D0%BD%D1%8B-ebuild%D1%8B","aria-label":"зачем нужны ebuildы permalink",className:"anchor before"},t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Зачем нужны ebuild'ы"),"\n",t.createElement(n.p,null,"Иногда какого-то нужного пакета может не оказаться ни в официальном репозитории\ngentoo, ни в каком-либо из оверлеев. В таком случае можно установить готовый (\nили написать свой ) ebuild.  Найти готовые ebuild'ы можно на ",t.createElement(n.a,{href:"https://bugs.gentoo.org/",target:"_blank",rel:"nofollow"},"bugs.gentoo.org"),", воспользовавшись строкой поиска. Давайте рассмотрим пример установки плагина ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">save for web</code>'}})," для графического редактора gimp."),"\n",t.createElement(n.p,null,"Итак, мы скачали необходимый ebuild. Теперь хорошо бы проверить наличие переменной ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">PORTDIR_OVERLAY</code>'}})," в ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">make.conf</code>'}}),":"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token assign-left variable">PORTDIR_OVERLAY</span><span class="token operator">=</span><span class="token string">"<span class="token variable">${PORTDIR_OVERLAY}</span> /usr/local/portage"</span></code></pre></div>'}}),"\n",t.createElement(n.p,null,"Структура любого оверлея копирует структуру официального дерева Portage: (категория/программа/название_программы-версия.ebuild).\nПроверьте наличие директории ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">/usr/local/portage</code>'}}),", и если её нет — создайте:"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token comment"># mkdir -p /usr/local/portage</span></code></pre></div>'}}),"\n",t.createElement(n.p,null,"Для того, чтобы Portage мог установить наш пакет, требуется digest-файл. Создайте его:"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token comment"># ebuild /usr/local/portage/category/program/program.ebuild digest</span></code></pre></div>'}}),"\n",t.createElement(n.p,null,"Применительно к save-for-web это будет выглядеть так:"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token comment"># ebuild /usr/local/portage/media-gfx/gimp-save-for-web/gimp-save-for-web-9999.ebuild</span></code></pre></div>'}}),"\n",t.createElement(n.p,null,"При установке такого пакета потребуется внести его в ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">/etc/portage/package.keywords</code>'}}),":"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">=media-gfx/gimp-save-for-web-9999 **</code></pre></div>'}}),"\n",t.createElement(n.p,null,t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">**</code>'}})," - разрешит поставить любую версию пакета, независимо от того, в какой ветке тот находится (в тестовой или стабильной).\nИ после этого установить:"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token comment"># emerge -av save-for-web</span></code></pre></div>'}}),"\n",t.createElement(n.h3,{id:"что-такое-слоты",style:{position:"relative"}},t.createElement(n.a,{href:"#%D1%87%D1%82%D0%BE-%D1%82%D0%B0%D0%BA%D0%BE%D0%B5-%D1%81%D0%BB%D0%BE%D1%82%D1%8B","aria-label":"что такое слоты permalink",className:"anchor before"},t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Что такое слоты"),"\n",t.createElement(n.p,null,"В большинстве других дистрибутивов устанавливается лишь одна версия пакета,\nв то время как в gentoo используется технология слотов. Пакет просто\nприсваивает определенный слот своей версии. При установке подобных приложений emerge выведет вам информацию, в которой будет указано какие новые пакеты будут установлены как зависимость устанавливаемого пакета (метапакеты), какие пакеты будут обновлены и какие будут установлены в другой слот. Последние обозначены как ",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">[NS]</code>'}}),".\nНаиболее простой пример - обновление ядра:"),"\n",t.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">[ebuild NS] sys-kernel/gentoo-sources-3.8.3:3.8.3 [3.8.2:3.8.2]</code></pre></div>'}}),"\n",t.createElement(n.p,null,"В принципе изложенной информации должно хватить для работы без экспериментов и неожиданностей.  Хотя рекомендуется ещё пройтись по форуму на предмет вопроса: ",t.createElement(n.a,{href:"http://gentoo.ru/node/26637",target:"_blank",rel:"nofollow"},"что читать после handbook"),".\nНа этом сегодня всё. Безоблачной жизни в gentoo, дамы и господа!"))}var c=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,l.MN)(),e.components);return n?t.createElement(n,e,t.createElement(s,e)):s(e)},o=a(7792),r=a(7619);function p(e){var n,a;let{data:{mdx:l},children:s,pageContext:{prev:c,next:p}}=e;const{h1:g,title:u,description:d,image:m,table_of_contents:i}=l.frontmatter;return(0,t.useEffect)((()=>{(0,r.K)()}),[]),t.createElement(t.Fragment,null,t.createElement(o._W,{h1:g,title:u,description:d,image:null===(n=l.frontmatter.image)||void 0===n?void 0:n.publicURL},t.createElement(o.MV,{post:l.frontmatter,imageData:null==m||null===(a=m.childImageSharp)||void 0===a?void 0:a.gatsbyImageData},i?t.createElement(o.G8,{headings:l.tableOfContents}):null,t.createElement("div",{className:"page__content"},s,t.createElement(o.Mf,{prev:c,next:p})),t.createElement(o.QZ,null))))}function g(e){return t.createElement(p,e,t.createElement(c,e))}},8876:function(e,n,a){a.d(n,{MN:function(){return s}});var l=a(4424);const t=l.createContext({});function s(e){const n=l.useContext(t);return l.useMemo((()=>"function"==typeof e?e(n):{...n,...e}),[n,e])}}}]);