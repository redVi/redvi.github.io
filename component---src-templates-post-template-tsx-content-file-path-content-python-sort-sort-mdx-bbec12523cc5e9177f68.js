"use strict";(self.webpackChunkgatsby_blog=self.webpackChunkgatsby_blog||[]).push([[2228],{8632:function(e,n,l){l.r(n),l.d(n,{Head:function(){return o.Ss},default:function(){return s}});var t=l(8876),r=l(4424);function a(e){const n=Object.assign({p:"p",code:"code",pre:"pre",ul:"ul",li:"li",h2:"h2",a:"a",span:"span"},(0,t.MN)(),e.components);return r.createElement(r.Fragment,null,r.createElement(n.p,null,"Ранее мы уже писали различные скрипты для примера использования возможностей языка ",r.createElement(n.code,null,"python"),", но не сказать, чтобы они были нужны в повседневности и могли претендовать на какое-то практическое применение. Сегодня же будет рассмотрен один очень небольшой и очень нужный (автору) скрипт. На его написание натолкнуло использование gentoo linux поэтому считаю, что он может быть небезынтересен пользователям этой операционной системы и прикрепляю соответствующий тег к посту."),"\n",r.createElement(n.p,null,"В чём суть работы скрипта: он сортирует в алфавитном порядке записи в ",r.createElement(n.code,null,"/etc/portage/*"),". При пополнении парка программ такие файлы как ",r.createElement(n.code,null,"package.use"),", ",r.createElement(n.code,null,"package.keywords")," и им подобные наполняются беспорядочными строками, в коих некоторое время спустя сложно найти что-то самому хозяину. Так расставим всё по местам!"),"\n",r.createElement(n.p,null,"Сначала приводится полный пример кода, содержащий менее двадцати строк, затем построчный разбор с комментариями."),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-python"},"# sort.py\n#\n#! /usr/bin/env python\n# -*- coding: utf-8 -*-\npackage = input('Choose file for sort: ')\ntry:\n    file = open(package, 'r+')\n    pos = 0\n    line = file.readlines()\n    file.seek(pos)\n    sort_text = sorted(line)\n    for new_line in sort_text:\n        file.write(new_line)\n        pos = file.tell()\n    file.close()\nexcept IOError:\n    print(\"No such file or directory. Repeat, please!\")\n")),"\n",r.createElement(n.p,null,"Первая строка указывает на расположение интерпретатора ",r.createElement(n.code,null,"python"),", вторая — на кодировку по-умолчанию."),"\n",r.createElement(n.p,null,"Далее вводится переменная package, которой будет присвоено значение указанное пользователем. Иными словами при запуске команды ",r.createElement(n.code,null,"sudo python sort.py")," будет запрошен путь к текстовому файлу, который в дальнейшем и подвергнется правке."),"\n",r.createElement(n.p,null,"Весь следующий блок кода обёрнут инструкцией ",r.createElement(n.code,null,"try-except"),", перехватывающей исключение ",r.createElement(n.code,null,"IOError"),". Это нужно для проверки ввода пользовательских данных. Например, вы могли ошибиться при наборе пути к файлу или ввели число. В таком случае вам укажут на вашу ошибку."),"\n",r.createElement(n.ul,null,"\n",r.createElement(n.li,null,"file = open(package, 'r+') — открыть выбранный пользователем файл для обновления."),"\n",r.createElement(n.li,null,"pos = 0 — установить позицию в начало"),"\n",r.createElement(n.li,null,"line = file.readlines() — построчное чтение из файла и присваивание переменной line получившегося списка"),"\n",r.createElement(n.li,null,"file.seek(pos) — перемещать позицию"),"\n",r.createElement(n.li,null,"sort_text = sorted(line) — получение нового отсортированного по алфавиту списка"),"\n"),"\n",r.createElement(n.p,null,"В следующем блоке проводится обход списка, перезапись выбранного файла, возвращение текущей позиции, закрытие файла:"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-python"},"for new_line in sort_text:\n    file.write(new_line)\n    pos = file.tell()\n    file.close()\n")),"\n",r.createElement(n.p,null,"Кроме того, можно проводить сортировку по ключу. Для этого достаточно создать дополнительную функцию. Например:"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-python"},"def sortByLenght(inputSrt):\n    return len(inputSrt)\n")),"\n",r.createElement(n.p,null,"Теперь можно вызывать функцию sorted с ключом:"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-shell"},">>> new_list = sorted(old_list, key=sortByLenght)\n")),"\n",r.createElement(n.h2,{id:"ещё-немного-теории-или-справка",style:{position:"relative"}},r.createElement(n.a,{href:"#%D0%B5%D1%89%D1%91-%D0%BD%D0%B5%D0%BC%D0%BD%D0%BE%D0%B3%D0%BE-%D1%82%D0%B5%D0%BE%D1%80%D0%B8%D0%B8-%D0%B8%D0%BB%D0%B8-%D1%81%D0%BF%D1%80%D0%B0%D0%B2%D0%BA%D0%B0","aria-label":"ещё немного теории или справка permalink",className:"anchor before"},r.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Ещё немного теории или справка:"),"\n",r.createElement(n.p,null,"Файл может быть открыт в режимах только для чтения, для записи, для обновления."),"\n",r.createElement(n.ul,null,"\n",r.createElement(n.li,null,"f = open('file') — откроет файл только для чтения"),"\n",r.createElement(n.li,null,"f = open('file', 'r') — то же самое"),"\n",r.createElement(n.li,null,"'w' — открытие файла для записи"),"\n",r.createElement(n.li,null,"'a' — для добавления в конец"),"\n",r.createElement(n.li,null,"'b' — указание на двоичные данные: ",r.createElement(n.code,null,"'wb'"),", ",r.createElement(n.code,null,"'rb'"),"."),"\n",r.createElement(n.li,null,"'t' — явное указание на то, что файл текстовый. Обычно не пишется"),"\n",r.createElement(n.li,null,"'w+' — открытие файла в режиме для обновления, в момент открытия файла его длина усекается до нуля, возможны чтение и запись"),"\n",r.createElement(n.li,null,"'r+' —  открытие файла в режиме для обновления, длина не усекается, возможны чтение и запись"),"\n",r.createElement(n.li,null,"метод readline() — читает одну строку, возвращает строку"),"\n",r.createElement(n.li,null,"метод readlines() — читает все строки из файла, возвращает список"),"\n",r.createElement(n.li,null,"метод tell() — возвращает текущую позицию в файле"),"\n",r.createElement(n.li,null,"метод seek() — перемещает текущую позицию в новое место"),"\n",r.createElement(n.li,null,"метод write() — запишет в файл одну строку"),"\n",r.createElement(n.li,null,"метод writelines() — запишет список строк"),"\n"))}var c=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,t.MN)(),e.components);return n?r.createElement(n,e,r.createElement(a,e)):a(e)},o=l(7792),i=l(7619);function u(e){var n,l;let{data:{mdx:t},children:a,pageContext:{prev:c,next:u}}=e;const{h1:s,title:m,description:p,image:E,table_of_contents:d}=t.frontmatter;return(0,r.useEffect)((()=>{(0,i.K)()}),[]),r.createElement(r.Fragment,null,r.createElement(o._W,{h1:s,title:m,description:p,image:null===(n=t.frontmatter.image)||void 0===n?void 0:n.publicURL},r.createElement(o.MV,{post:t.frontmatter,imageData:null==E||null===(l=E.childImageSharp)||void 0===l?void 0:l.gatsbyImageData},d?r.createElement(o.G8,{headings:t.tableOfContents}):null,r.createElement("div",{className:"page__content"},a,r.createElement(o.Mf,{prev:c,next:u})),r.createElement(o.QZ,null))))}function s(e){return r.createElement(u,e,r.createElement(c,e))}},8876:function(e,n,l){l.d(n,{MN:function(){return a}});var t=l(4424);const r=t.createContext({});function a(e){const n=t.useContext(r);return t.useMemo((()=>"function"==typeof e?e(n):{...n,...e}),[n,e])}}}]);