"use strict";(self.webpackChunkgatsby_blog=self.webpackChunkgatsby_blog||[]).push([[552],{1080:function(e,n,t){t.r(n),t.d(n,{Head:function(){return i.Ss},default:function(){return m}});var l=t(8876),a=t(4424);function c(e){const n=Object.assign({p:"p",code:"code",a:"a",pre:"pre",span:"span",h2:"h2",ol:"ol",li:"li",ul:"ul",h3:"h3",em:"em"},(0,l.MN)(),e.components);return a.createElement(a.Fragment,null,a.createElement(n.p,null,"TeX и LaTeX отлично подходят для создания разного рода электронных книг. Книги\nформата ",a.createElement(n.code,null,".pdf")," создаются легко и, более того, у LaTeX имеется нативная поддержка\nданного формата. Как уже не раз ",a.createElement(n.a,{href:"/posts/texreview/"},"было показано ранее"),", следует\nлишь ввести команду для сборки pdf-файла из tex-файла, например:"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-shell"},"$ pdflatex my_book.tex\n")),"\n",a.createElement(n.p,null,"Но как обстоят дела с другими форматами? Многие имеют в своём распоряжении\nсмартфоны или планшеты и, разумеется, читают с экранов этих устройств книги. В\nметро, по пути на работу, в парке, выгуливая собаку, да мало ли где ещё. Но\nпорази меня гром, читать ",a.createElement(n.code,null,"pdf")," с подобных девайсов совершенно неудобно."),"\n",a.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 594px; flex:3;"\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 31%; position: relative; bottom: 0; left: 0; display: block;"\n  ></span>\n  <picture>\n          <source\n              srcset="/static/3c5a62f9f73e2264730f46bd86609e74/e93cc/epub.webp 300w,\n/static/3c5a62f9f73e2264730f46bd86609e74/5258d/epub.webp 594w"\n              sizes="(max-width: 594px) 100vw, 594px"\n              type="image/webp"\n            />\n          <source\n            srcset="/static/3c5a62f9f73e2264730f46bd86609e74/eed55/epub.png 300w,\n/static/3c5a62f9f73e2264730f46bd86609e74/ff7bb/epub.png 594w"\n            sizes="(max-width: 594px) 100vw, 594px"\n            type="image/png"\n          />\n          <img\n            class="gatsby-resp-image-image"\n            src="/static/3c5a62f9f73e2264730f46bd86609e74/ff7bb/epub.png"\n            alt="Gadgets"\n            title="Devices"\n            loading="lazy"\n            decoding="async"\n            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n          />\n        </picture>\n    </span>'}}),"\n",a.createElement(n.p,null,"Итак, что такое ePub и как конвертировать вашу собственную книгу из ",a.createElement(n.code,null,"tex")," в\n",a.createElement(n.code,null,"epub"),"?"),"\n",a.createElement(n.h2,{id:"что-такое-epub",style:{position:"relative"}},a.createElement(n.a,{href:"#%D1%87%D1%82%D0%BE-%D1%82%D0%B0%D0%BA%D0%BE%D0%B5-epub","aria-label":"что такое epub permalink",className:"anchor before"},a.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Что такое ePub?"),"\n",a.createElement(n.p,null,"EPUB (electronic publication) — один из форматов электронных книг. Вообще,\nкнига формата ePub является по сути своей документом XHTML, в котором содержится\nсам текст + XML с описанием книги. Последний может выводить оглавление с\nнавигационными ссылками."),"\n",a.createElement(n.p,null,"Конвертация ",a.createElement(n.code,null,"tex")," в ",a.createElement(n.code,null,"epub")," состоит из двух действий:"),"\n",a.createElement(n.ol,null,"\n",a.createElement(n.li,null,"конвертировать книгу в XHTML"),"\n",a.createElement(n.li,null,"запаковать XHTML в epub-файл"),"\n"),"\n",a.createElement(n.h2,{id:"переводим-tex-в-xhtml",style:{position:"relative"}},a.createElement(n.a,{href:"#%D0%BF%D0%B5%D1%80%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D0%BC-tex-%D0%B2-xhtml","aria-label":"переводим tex в xhtml permalink",className:"anchor before"},a.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Переводим tex в XHTML"),"\n",a.createElement(n.p,null,"В Linux доступны две отличные программы для преобразования чего угодно во что\nугодно: это pandoc и calibre. Но мы пойдём другим путём и вместо того, чтобы\nтащить многочисленные библиотеки Qt (calibre) или же over 90 пакетов haskell\n(pandoc) установим небольшую консольную программу с наименованием ",a.createElement(n.code,null,"tth"),":"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-shell"},"# emerge -apv tth\n")),"\n",a.createElement(n.p,null,"С TtH перегнать книгу в XHTML не составит труда:"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-shell"},"$ tth -w2 -e2 -u my_book.tex\n")),"\n",a.createElement(n.p,null,"Эта команда создаст файл с расширением ",a.createElement(n.code,null,".html")," в текущей директории."),"\n",a.createElement(n.ul,null,"\n",a.createElement(n.li,null,"флаг ",a.createElement(n.code,null,"-w2")," гарантирует получение XHTML в выводе"),"\n",a.createElement(n.li,null,"флаг ",a.createElement(n.code,null,"-e2")," встраивает графику из tex-файла"),"\n",a.createElement(n.li,null,"флаг ",a.createElement(n.code,null,"-u")," обеспечивает поддержку юникода, по-умолчанию используется iso-8859-1"),"\n",a.createElement(n.li,null,"справку можно вызвать командой ",a.createElement(n.code,null,"tth -?")),"\n"),"\n",a.createElement(n.p,null,"Это всё, первый шаг сделан."),"\n",a.createElement(n.h2,{id:"включаем-метаданные",style:{position:"relative"}},a.createElement(n.a,{href:"#%D0%B2%D0%BA%D0%BB%D1%8E%D1%87%D0%B0%D0%B5%D0%BC-%D0%BC%D0%B5%D1%82%D0%B0%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5","aria-label":"включаем метаданные permalink",className:"anchor before"},a.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Включаем метаданные"),"\n",a.createElement(n.p,null,"Для этого установим ещё одну небольшую программу, требующую минимального количества\nзависимостей (хотя и оно тянет ",a.createElement(n.code,null,"qtgui, qtwebkit"),", намекая на пристрастия разработчиков),\nа именно ",a.createElement(n.code,null,"sigil"),":"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-shell"},"# emerge -apv sigil\n")),"\n",a.createElement(n.p,null,"Теперь откройте sigil и выбирайте вашу книгу, внести необходимые изменения и\nсохраните их. Какие изменения? Дело в том, что нам нужно удостовериться в\nправильности генерируемого XML-файла. В частности оглавления и валидации."),"\n",a.createElement(n.h3,{id:"оглавление",style:{position:"relative"}},a.createElement(n.a,{href:"#%D0%BE%D0%B3%D0%BB%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5","aria-label":"оглавление permalink",className:"anchor before"},a.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Оглавление"),"\n",a.createElement(n.p,null,"Должно быть, ваш tex-документ уже содержит созданное автоматически содержание\nкниги, не так ли? Если оно сгенерировано самим LaTeX, TtH переведёт его в XHTML\nбез указаний сверху. А вот TOC (Table of Content) файл ",a.createElement(n.em,null,"для ePub")," должен быть сгенерирован\nотдельно. Для этого воспользуйтесь командой меню ",a.createElement(n.code,null,"Generate TOC from headings"),",\nздесь всё просто."),"\n",a.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 593px; flex:1;"\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 83.33333333333334%; position: relative; bottom: 0; left: 0; display: block;"\n  ></span>\n  <picture>\n          <source\n              srcset="/static/9bf3e3aaa1286b541cb5ed5a8d3221a7/e93cc/epub2.webp 300w,\n/static/9bf3e3aaa1286b541cb5ed5a8d3221a7/19252/epub2.webp 593w"\n              sizes="(max-width: 593px) 100vw, 593px"\n              type="image/webp"\n            />\n          <source\n            srcset="/static/9bf3e3aaa1286b541cb5ed5a8d3221a7/eed55/epub2.png 300w,\n/static/9bf3e3aaa1286b541cb5ed5a8d3221a7/c8356/epub2.png 593w"\n            sizes="(max-width: 593px) 100vw, 593px"\n            type="image/png"\n          />\n          <img\n            class="gatsby-resp-image-image"\n            src="/static/9bf3e3aaa1286b541cb5ed5a8d3221a7/c8356/epub2.png"\n            alt="ePub"\n            title="ePub Book"\n            loading="lazy"\n            decoding="async"\n            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n          />\n        </picture>\n    </span>'}}),"\n",a.createElement(n.h3,{id:"валидация-документа",style:{position:"relative"}},a.createElement(n.a,{href:"#%D0%B2%D0%B0%D0%BB%D0%B8%D0%B4%D0%B0%D1%86%D0%B8%D1%8F-%D0%B4%D0%BE%D0%BA%D1%83%D0%BC%D0%B5%D0%BD%D1%82%D0%B0","aria-label":"валидация документа permalink",className:"anchor before"},a.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Валидация документа"),"\n",a.createElement(n.p,null,"Следующим шагом будет проверка валидации: ",a.createElement(n.code,null,"Tools -> Validate ePub"),". К несчастью,\nполучаем две ошибки:"),"\n",a.createElement(n.ul,null,"\n",a.createElement(n.li,null,'"The < language > element is missing"'),"\n",a.createElement(n.li,null,'"The < title > element is missing"'),"\n"),"\n",a.createElement(n.p,null,"То есть не указан язык документа и его название. Дабы исправить это досадное\nнедоразумение отправляемся к настройкам ",a.createElement(n.code,null,"Tools -> Meta data")," и вносим\nсоответствующие правки."),"\n",a.createElement(n.p,null,'Когда закончите с этим, проверьте валиден ли документ ещё раз. Если всё в\nпорядке, вы должны получить сообщение "No problems found".'),"\n",a.createElement(n.p,null,"В принципе для второго этапа может подойти и какой-нибудь онлайн-конвертер, хотя\nавтору не попадался ни один, который генерировал бы корректное содержание для книги epub."))}var r=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,l.MN)(),e.components);return n?a.createElement(n,e,a.createElement(c,e)):c(e)},i=t(7792),s=t(7619);function o(e){var n,t;let{data:{mdx:l},children:c,pageContext:{prev:r,next:o}}=e;const{h1:m,title:p,description:u,image:d,table_of_contents:h}=l.frontmatter;return(0,a.useEffect)((()=>{(0,s.K)()}),[]),a.createElement(a.Fragment,null,a.createElement(i._W,{h1:m,title:p,description:u,image:null===(n=l.frontmatter.image)||void 0===n?void 0:n.publicURL},a.createElement(i.MV,{post:l.frontmatter,imageData:null==d||null===(t=d.childImageSharp)||void 0===t?void 0:t.gatsbyImageData},h?a.createElement(i.G8,{headings:l.tableOfContents}):null,a.createElement("div",{className:"page__content"},c,a.createElement(i.Mf,{prev:r,next:o})),a.createElement(i.QZ,null))))}function m(e){return a.createElement(o,e,a.createElement(r,e))}},8876:function(e,n,t){t.d(n,{MN:function(){return c}});var l=t(4424);const a=l.createContext({});function c(e){const n=l.useContext(a);return l.useMemo((()=>"function"==typeof e?e(n):{...n,...e}),[n,e])}}}]);