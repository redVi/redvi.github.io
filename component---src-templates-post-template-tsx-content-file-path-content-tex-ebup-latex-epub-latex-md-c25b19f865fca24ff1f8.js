"use strict";(self.webpackChunkgatsby_blog=self.webpackChunkgatsby_blog||[]).push([[552],{1080:function(e,n,t){t.r(n),t.d(n,{Head:function(){return r.Ss},default:function(){return p}});var a=t(8876),l=t(4424);function s(e){const n=Object.assign({p:"p",span:"span",a:"a",h2:"h2",ol:"ol",li:"li",ul:"ul",h3:"h3",em:"em"},(0,a.MN)(),e.components);return l.createElement(l.Fragment,null,l.createElement(n.p,null,"TeX и LaTeX отлично подходят для создания разного рода электронных книг. Книги\nформата ",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">.pdf</code>'}})," создаются легко и, более того, у LaTeX имеется нативная поддержка\nданного формата. Как уже не раз ",l.createElement(n.a,{href:"/posts/texreview/"},"было показано ранее"),", следует\nлишь ввести команду для сборки pdf-файла из tex-файла, например:"),"\n",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">$ pdflatex my_book.tex</code></pre></div>'}}),"\n",l.createElement(n.p,null,"Но как обстоят дела с другими форматами? Многие имеют в своём распоряжении\nсмартфоны или планшеты и, разумеется, читают с экранов этих устройств книги. В\nметро, по пути на работу, в парке, выгуливая собаку, да мало ли где ещё. Но\nпорази меня гром, читать ",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">pdf</code>'}})," с подобных девайсов совершенно неудобно."),"\n",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 594px; flex:3;"\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 31%; position: relative; bottom: 0; left: 0; display: block;"\n  ></span>\n  <picture>\n          <source\n              srcset="/static/3c5a62f9f73e2264730f46bd86609e74/e93cc/epub.webp 300w,\n/static/3c5a62f9f73e2264730f46bd86609e74/5258d/epub.webp 594w"\n              sizes="(max-width: 594px) 100vw, 594px"\n              type="image/webp"\n            />\n          <source\n            srcset="/static/3c5a62f9f73e2264730f46bd86609e74/eed55/epub.png 300w,\n/static/3c5a62f9f73e2264730f46bd86609e74/ff7bb/epub.png 594w"\n            sizes="(max-width: 594px) 100vw, 594px"\n            type="image/png"\n          />\n          <img\n            class="gatsby-resp-image-image"\n            src="/static/3c5a62f9f73e2264730f46bd86609e74/ff7bb/epub.png"\n            alt="Gadgets"\n            title="Devices"\n            loading="lazy"\n            decoding="async"\n            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n          />\n        </picture>\n    </span>'}}),"\n",l.createElement(n.p,null,"Итак, что такое ePub и как конвертировать вашу собственную книгу из ",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">tex</code>'}})," в\n",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">epub</code>'}}),"?"),"\n",l.createElement(n.h2,{id:"что-такое-epub",style:{position:"relative"}},l.createElement(n.a,{href:"#%D1%87%D1%82%D0%BE-%D1%82%D0%B0%D0%BA%D0%BE%D0%B5-epub","aria-label":"что такое epub permalink",className:"anchor before"},l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Что такое ePub?"),"\n",l.createElement(n.p,null,"EPUB (electronic publication) — один из форматов электронных книг. Вообще,\nкнига формата ePub является по сути своей документом XHTML, в котором содержится\nсам текст + XML с описанием книги. Последний может выводить оглавление с\nнавигационными ссылками."),"\n",l.createElement(n.p,null,"Конвертация ",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">tex</code>'}})," в ",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">epub</code>'}})," состоит из двух действий:"),"\n",l.createElement(n.ol,null,"\n",l.createElement(n.li,null,"конвертировать книгу в XHTML"),"\n",l.createElement(n.li,null,"запаковать XHTML в epub-файл"),"\n"),"\n",l.createElement(n.h2,{id:"переводим-tex-в-xhtml",style:{position:"relative"}},l.createElement(n.a,{href:"#%D0%BF%D0%B5%D1%80%D0%B5%D0%B2%D0%BE%D0%B4%D0%B8%D0%BC-tex-%D0%B2-xhtml","aria-label":"переводим tex в xhtml permalink",className:"anchor before"},l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Переводим tex в XHTML"),"\n",l.createElement(n.p,null,"В Linux доступны две отличные программы для преобразования чего угодно во что\nугодно: это pandoc и calibre. Но мы пойдём другим путём и вместо того, чтобы\nтащить многочисленные библиотеки Qt (calibre) или же over 90 пакетов haskell\n(pandoc) установим небольшую консольную программу с наименованием ",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">tth</code>'}}),":"),"\n",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token comment"># emerge -apv tth</span></code></pre></div>'}}),"\n",l.createElement(n.p,null,"С TtH перегнать книгу в XHTML не составит труда:"),"\n",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">$ tth <span class="token parameter variable">-w2</span> <span class="token parameter variable">-e2</span> <span class="token parameter variable">-u</span> my_book.tex</code></pre></div>'}}),"\n",l.createElement(n.p,null,"Эта команда создаст файл с расширением ",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">.html</code>'}})," в текущей директории."),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"флаг ",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">-w2</code>'}})," гарантирует получение XHTML в выводе"),"\n",l.createElement(n.li,null,"флаг ",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">-e2</code>'}})," встраивает графику из tex-файла"),"\n",l.createElement(n.li,null,"флаг ",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">-u</code>'}})," обеспечивает поддержку юникода, по-умолчанию используется iso-8859-1"),"\n",l.createElement(n.li,null,"справку можно вызвать командой ",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">tth -?</code>'}})),"\n"),"\n",l.createElement(n.p,null,"Это всё, первый шаг сделан."),"\n",l.createElement(n.h2,{id:"включаем-метаданные",style:{position:"relative"}},l.createElement(n.a,{href:"#%D0%B2%D0%BA%D0%BB%D1%8E%D1%87%D0%B0%D0%B5%D0%BC-%D0%BC%D0%B5%D1%82%D0%B0%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5","aria-label":"включаем метаданные permalink",className:"anchor before"},l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Включаем метаданные"),"\n",l.createElement(n.p,null,"Для этого установим ещё одну небольшую программу, требующую минимального количества\nзависимостей (хотя и оно тянет ",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">qtgui, qtwebkit</code>'}}),", намекая на пристрастия разработчиков),\nа именно ",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">sigil</code>'}}),":"),"\n",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token comment"># emerge -apv sigil</span></code></pre></div>'}}),"\n",l.createElement(n.p,null,"Теперь откройте sigil и выбирайте вашу книгу, внести необходимые изменения и\nсохраните их. Какие изменения? Дело в том, что нам нужно удостовериться в\nправильности генерируемого XML-файла. В частности оглавления и валидации."),"\n",l.createElement(n.h3,{id:"оглавление",style:{position:"relative"}},l.createElement(n.a,{href:"#%D0%BE%D0%B3%D0%BB%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5","aria-label":"оглавление permalink",className:"anchor before"},l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Оглавление"),"\n",l.createElement(n.p,null,"Должно быть, ваш tex-документ уже содержит созданное автоматически содержание\nкниги, не так ли? Если оно сгенерировано самим LaTeX, TtH переведёт его в XHTML\nбез указаний сверху. А вот TOC (Table of Content) файл ",l.createElement(n.em,null,"для ePub")," должен быть сгенерирован\nотдельно. Для этого воспользуйтесь командой меню ",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">Generate TOC from headings</code>'}}),",\nздесь всё просто."),"\n",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 593px; flex:1;"\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 83.33333333333334%; position: relative; bottom: 0; left: 0; display: block;"\n  ></span>\n  <picture>\n          <source\n              srcset="/static/9bf3e3aaa1286b541cb5ed5a8d3221a7/e93cc/epub2.webp 300w,\n/static/9bf3e3aaa1286b541cb5ed5a8d3221a7/19252/epub2.webp 593w"\n              sizes="(max-width: 593px) 100vw, 593px"\n              type="image/webp"\n            />\n          <source\n            srcset="/static/9bf3e3aaa1286b541cb5ed5a8d3221a7/eed55/epub2.png 300w,\n/static/9bf3e3aaa1286b541cb5ed5a8d3221a7/c8356/epub2.png 593w"\n            sizes="(max-width: 593px) 100vw, 593px"\n            type="image/png"\n          />\n          <img\n            class="gatsby-resp-image-image"\n            src="/static/9bf3e3aaa1286b541cb5ed5a8d3221a7/c8356/epub2.png"\n            alt="ePub"\n            title="ePub Book"\n            loading="lazy"\n            decoding="async"\n            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n          />\n        </picture>\n    </span>'}}),"\n",l.createElement(n.h3,{id:"валидация-документа",style:{position:"relative"}},l.createElement(n.a,{href:"#%D0%B2%D0%B0%D0%BB%D0%B8%D0%B4%D0%B0%D1%86%D0%B8%D1%8F-%D0%B4%D0%BE%D0%BA%D1%83%D0%BC%D0%B5%D0%BD%D1%82%D0%B0","aria-label":"валидация документа permalink",className:"anchor before"},l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Валидация документа"),"\n",l.createElement(n.p,null,"Следующим шагом будет проверка валидации: ",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">Tools -> Validate ePub</code>'}}),". К несчастью,\nполучаем две ошибки:"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,'"The < language > element is missing"'),"\n",l.createElement(n.li,null,'"The < title > element is missing"'),"\n"),"\n",l.createElement(n.p,null,"То есть не указан язык документа и его название. Дабы исправить это досадное\nнедоразумение отправляемся к настройкам ",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">Tools -> Meta data</code>'}})," и вносим\nсоответствующие правки."),"\n",l.createElement(n.p,null,'Когда закончите с этим, проверьте валиден ли документ ещё раз. Если всё в\nпорядке, вы должны получить сообщение "No problems found".'),"\n",l.createElement(n.p,null,"В принципе для второго этапа может подойти и какой-нибудь онлайн-конвертер, хотя\nавтору не попадался ни один, который генерировал бы корректное содержание для книги epub."))}var c=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,a.MN)(),e.components);return n?l.createElement(n,e,l.createElement(s,e)):s(e)},r=t(7792),i=t(7619);function o(e){var n,t;let{data:{mdx:a},children:s,pageContext:{prev:c,next:o}}=e;const{h1:p,title:m,description:g,image:d,table_of_contents:u}=a.frontmatter;return(0,l.useEffect)((()=>{(0,i.K)()}),[]),l.createElement(l.Fragment,null,l.createElement(r._W,{h1:p,title:m,description:g,image:null===(n=a.frontmatter.image)||void 0===n?void 0:n.publicURL},l.createElement(r.MV,{post:a.frontmatter,imageData:null==d||null===(t=d.childImageSharp)||void 0===t?void 0:t.gatsbyImageData},u?l.createElement(r.G8,{headings:a.tableOfContents}):null,l.createElement("div",{className:"page__content"},s,l.createElement(r.Mf,{prev:c,next:o})),l.createElement(r.QZ,null))))}function p(e){return l.createElement(o,e,l.createElement(c,e))}},8876:function(e,n,t){t.d(n,{MN:function(){return s}});var a=t(4424);const l=a.createContext({});function s(e){const n=a.useContext(l);return a.useMemo((()=>"function"==typeof e?e(n):{...n,...e}),[n,e])}}}]);